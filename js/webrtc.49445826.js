(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["webrtc"],{"0293":function(e,t,o){"use strict";o("4bdd")},"25f0":function(e,t,o){"use strict";var n=o("e330"),r=o("5e77").PROPER,i=o("6eeb"),a=o("825a"),c=o("3a9b"),s=o("577e"),u=o("d039"),d=o("ad6d"),l="toString",f=RegExp.prototype,p=f[l],g=n(d),m=u((function(){return"/a/b"!=p.call({source:"a",flags:"b"})})),h=r&&p.name!=l;(m||h)&&i(RegExp.prototype,l,(function(){var e=a(this),t=s(e.source),o=e.flags,n=s(void 0===o&&c(f,e)&&!("flags"in f)?g(e):o);return"/"+t+"/"+n}),{unsafe:!0})},"2c3e":function(e,t,o){var n=o("da84"),r=o("83ab"),i=o("9f7f").UNSUPPORTED_Y,a=o("c6b6"),c=o("9bf2").f,s=o("69f3").get,u=RegExp.prototype,d=n.TypeError;r&&i&&c(u,"sticky",{configurable:!0,get:function(){if(this!==u){if("RegExp"===a(this))return!!s(this).sticky;throw d("Incompatible receiver, RegExp required")}}})},"466d":function(e,t,o){"use strict";var n=o("c65b"),r=o("d784"),i=o("825a"),a=o("50c4"),c=o("577e"),s=o("1d80"),u=o("dc4a"),d=o("8aa5"),l=o("14c3");r("match",(function(e,t,o){return[function(t){var o=s(this),r=void 0==t?void 0:u(t,e);return r?n(r,t,o):new RegExp(t)[e](c(o))},function(e){var n=i(this),r=c(e),s=o(t,n,r);if(s.done)return s.value;if(!n.global)return l(n,r);var u=n.unicode;n.lastIndex=0;var f,p=[],g=0;while(null!==(f=l(n,r))){var m=c(f[0]);p[g]=m,""===m&&(n.lastIndex=d(r,a(n.lastIndex),u)),g++}return 0===g?null:p}]}))},"4bdd":function(e,t,o){},"4d63":function(e,t,o){var n=o("83ab"),r=o("da84"),i=o("e330"),a=o("94ca"),c=o("7156"),s=o("9112"),u=o("9bf2").f,d=o("241c").f,l=o("3a9b"),f=o("44e7"),p=o("577e"),g=o("ad6d"),m=o("9f7f"),h=o("6eeb"),v=o("d039"),b=o("1a2d"),w=o("69f3").enforce,E=o("2626"),x=o("b622"),y=o("fce3"),R=o("107c"),U=x("match"),S=r.RegExp,C=S.prototype,D=r.SyntaxError,T=i(g),O=i(C.exec),I=i("".charAt),P=i("".replace),k=i("".indexOf),N=i("".slice),M=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,A=/a/g,j=/a/g,q=new S(A)!==A,V=m.UNSUPPORTED_Y,_=n&&(!q||V||y||R||v((function(){return j[U]=!1,S(A)!=A||S(j)==j||"/a/i"!=S(A,"i")}))),W=function(e){for(var t,o=e.length,n=0,r="",i=!1;n<=o;n++)t=I(e,n),"\\"!==t?i||"."!==t?("["===t?i=!0:"]"===t&&(i=!1),r+=t):r+="[\\s\\S]":r+=t+I(e,++n);return r},$=function(e){for(var t,o=e.length,n=0,r="",i=[],a={},c=!1,s=!1,u=0,d="";n<=o;n++){if(t=I(e,n),"\\"===t)t+=I(e,++n);else if("]"===t)c=!1;else if(!c)switch(!0){case"["===t:c=!0;break;case"("===t:O(M,N(e,n+1))&&(n+=2,s=!0),r+=t,u++;continue;case">"===t&&s:if(""===d||b(a,d))throw new D("Invalid capture group name");a[d]=!0,i[i.length]=[d,u],s=!1,d="";continue}s?d+=t:r+=t}return[r,i]};if(a("RegExp",_)){for(var B=function(e,t){var o,n,r,i,a,u,d=l(C,this),g=f(e),m=void 0===t,h=[],v=e;if(!d&&g&&m&&e.constructor===B)return e;if((g||l(C,e))&&(e=e.source,m&&(t="flags"in v?v.flags:T(v))),e=void 0===e?"":p(e),t=void 0===t?"":p(t),v=e,y&&"dotAll"in A&&(n=!!t&&k(t,"s")>-1,n&&(t=P(t,/s/g,""))),o=t,V&&"sticky"in A&&(r=!!t&&k(t,"y")>-1,r&&(t=P(t,/y/g,""))),R&&(i=$(e),e=i[0],h=i[1]),a=c(S(e,t),d?this:C,B),(n||r||h.length)&&(u=w(a),n&&(u.dotAll=!0,u.raw=B(W(e),o)),r&&(u.sticky=!0),h.length&&(u.groups=h)),e!==v)try{s(a,"source",""===v?"(?:)":v)}catch(b){}return a},J=function(e){e in B||u(B,e,{configurable:!0,get:function(){return S[e]},set:function(t){S[e]=t}})},L=d(S),Y=0;L.length>Y;)J(L[Y++]);C.constructor=B,B.prototype=C,h(r,"RegExp",B)}E("RegExp")},7156:function(e,t,o){var n=o("1626"),r=o("861d"),i=o("d2bb");e.exports=function(e,t,o){var a,c;return i&&n(a=t.constructor)&&a!==o&&r(c=a.prototype)&&c!==o.prototype&&i(e,c),e}},"72a0":function(e,t,o){"use strict";o.r(t);var n,r,i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"chatroom"},[e._v(" 房间地址："),o("input",{directives:[{name:"model",rawName:"v-model",value:e.roomUrl,expression:"roomUrl"}],staticClass:"roomUrl",attrs:{readonly:"true"},domProps:{value:e.roomUrl},on:{input:function(t){t.target.composing||(e.roomUrl=t.target.value)}}}),o("br"),o("video",{attrs:{width:"640px",height:"480px",id:"myVideo"}}),o("video",{attrs:{width:"240px",height:"160px",id:"remoteVideo"}})])},a=[],c=o("1da1"),s=(o("96cf"),o("ac1f"),o("1276"),o("4d63"),o("c607"),o("2c3e"),o("25f0"),o("466d"),{name:"userMedia",data:function(){return{roomUrl:"",roomName:""}},mounted:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$nextTick((function(){var t=e.getUrlParam("room");t?(e.roomName="observable-"+t.split("-")[1],e.roomUrl=location.href):(e.roomName="observable-"+Date.now(),e.roomUrl=location.href+"?room=".concat(e.roomName)),e.start()}));case 1:case"end":return t.stop()}}),t)})))()},methods:{getUrlParam:function(e){var t=new RegExp("(\\?|&)"+e+"=([^&]*)(&|$)"),o=window.location.href.substr(1).match(t);return null!=o?unescape(o[2]):null},start:function(){var e=this;n=new window.ScaleDrone("OXo4HSBTCQ8ehrxI"),n.on("open",(function(t){if(t)return console.error(t);var o=n.subscribe(e.roomName);o.on("open",(function(e){e&&this.onError(e)})),o.on("members",(function(t){console.log("MEMBERS",t);var o=2===t.length;e.startWebRTC(o)})),o.on("data",(function(t,o){o.id!==n.clientId&&(t.sdp?(console.log("sdp消息：",t),r.setRemoteDescription(new RTCSessionDescription(t.sdp),(function(){console.log("sdp消息类型：",r.remoteDescription.type),"offer"===r.remoteDescription.type&&r.createAnswer().then((function(t){r.setLocalDescription(t,(function(){e.sendMessage({sdp:r.localDescription})}),e.onError)})).catch(e.onError)}),e.onError)):t.candidate&&(console.log("candidate消息：",t),r.addIceCandidate(new RTCIceCandidate(t.candidate))))}))}))},startWebRTC:function(e){var t=this,o={iceServers:[{urls:"stun:stun.l.google.com:19302"}]};console.log("startWebRTC, connect to stun server"),r=new RTCPeerConnection(o),r.onicecandidate=function(e){e.candidate&&(console.log(">>>>onicecandidate"),t.sendMessage({candidate:e.candidate}))},e&&(r.onnegotiationneeded=function(){r.createOffer().then((function(e){r.setLocalDescription(e,(function(){t.sendMessage({sdp:r.localDescription})}),t.onError)})).catch(t.onError)}),r.onaddstream=function(e){document.querySelector("#remoteVideo").srcObject=e.stream;var t=document.querySelector("#myVideo");t.srcObject=e.stream,t.play()},window.navigator.getUserMedia({audio:!0,video:!0},(function(e){var t=document.querySelector("#myVideo");console.log("start local stream"),t.srcObject=e,t.play(),r.addStream(e)}),this.onError)},sendMessage:function(e){n.publish({room:this.roomName,message:e})},onError:function(e){console.log(e)}}}),u=s,d=(o("0293"),o("2877")),l=Object(d["a"])(u,i,a,!1,null,"399cbde2",null);t["default"]=l.exports},c607:function(e,t,o){var n=o("da84"),r=o("83ab"),i=o("fce3"),a=o("c6b6"),c=o("9bf2").f,s=o("69f3").get,u=RegExp.prototype,d=n.TypeError;r&&i&&c(u,"dotAll",{configurable:!0,get:function(){if(this!==u){if("RegExp"===a(this))return!!s(this).dotAll;throw d("Incompatible receiver, RegExp required")}}})}}]);
//# sourceMappingURL=webrtc.49445826.js.map